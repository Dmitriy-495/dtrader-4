# –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ WebSocket —Å–µ—Ä–≤–µ—Ä–∞

## –û–±–∑–æ—Ä

–ü—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ –Ω–æ–≤–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞ –∫ WebSocket —Å–µ—Ä–≤–µ—Ä—É, —Å–µ—Ä–≤–µ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Ç–∏–ø–∞ `system:welcome`. –≠—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –≤–∞–∂–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å–µ—Ä–≤–µ—Ä–µ, –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏—è—Ö –∏ —Ç–µ–∫—É—â–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏ —Å–∏—Å—Ç–µ–º—ã.

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–æ–æ–±—â–µ–Ω–∏—è

```json
{
  "type": "system:welcome",
  "clientId": "CLIENT-1234567890-1234",
  "timestamp": 1765738164429,
  "message": "üéâ Welcome to DTrader WebSocket Server Instance D!",
  "serverInfo": {
    "version": "1.0.0",
    "instance": "D",
    "protocolVersion": "2.0",
    "nodeEnv": "development",
    "uptime": 123.45
  },
  "connectionInfo": {
    "clientId": "CLIENT-1234567890-1234",
    "connectedAt": 1765738164429,
    "serverTime": "2025-12-14T18:49:24.430Z",
    "websocketPort": 2808
  },
  "systemStatus": {
    "redisConnected": true,
    "botStatus": "idle",
    "traderStatus": "idle",
    "lastTradeSignal": "None"
  },
  "availableEvents": [
    "system:status",
    "trade:signal",
    "trade:executed",
    "trade:error",
    "market:update",
    "ping",
    "pong"
  ],
  "availableCommands": {
    "subscribe": "Subscribe to specific events",
    "unsubscribe": "Unsubscribe from events",
    "status": "Get current system status",
    "help": "Get help information"
  },
  "documentation": {
    "api": "https://dtrader.example.com/api-docs",
    "github": "https://github.com/dtrader-team/dtrader",
    "support": "support@dtrader.example.com"
  },
  "tips": [
    "Use {\"type\":\"ping\"} to check connection health",
    "Send {\"type\":\"status\"} to get current system status",
    "All messages must be valid JSON",
    "Maximum message size: 16KB"
  ]
}
```

## –ü–æ–ª—è —Å–æ–æ–±—â–µ–Ω–∏—è

### –û—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–ª—è

| –ü–æ–ª–µ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|-----|----------|
| `type` | string | –¢–∏–ø —Å–æ–æ–±—â–µ–Ω–∏—è, –≤—Å–µ–≥–¥–∞ `"system:welcome"` |
| `clientId` | string | –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∫–ª–∏–µ–Ω—Ç–∞ |
| `timestamp` | number | –í—Ä–µ–º–µ–Ω–Ω–∞—è –º–µ—Ç–∫–∞ –≤ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥–∞—Ö |
| `message` | string | –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å —ç–º–æ–¥–∑–∏ üéâ |

### Server Info

| –ü–æ–ª–µ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|-----|----------|
| `version` | string | –í–µ—Ä—Å–∏—è —Å–µ—Ä–≤–µ—Ä–∞ |
| `instance` | string | –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∏–Ω—Å—Ç–∞–Ω—Å–∞ (A, B, C, D) |
| `protocolVersion` | string | –í–µ—Ä—Å–∏—è –ø—Ä–æ—Ç–æ–∫–æ–ª–∞ |
| `nodeEnv` | string | –†–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã (development, production) |
| `uptime` | number | –í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã —Å–µ—Ä–≤–µ—Ä–∞ –≤ —Å–µ–∫—É–Ω–¥–∞—Ö |

### Connection Info

| –ü–æ–ª–µ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|-----|----------|
| `clientId` | string | –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∫–ª–∏–µ–Ω—Ç–∞ |
| `connectedAt` | number | –í—Ä–µ–º—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –≤ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥–∞—Ö |
| `serverTime` | string | –¢–µ–∫—É—â–µ–µ —Å–µ—Ä–≤–µ—Ä–Ω–æ–µ –≤—Ä–µ–º—è –≤ ISO —Ñ–æ—Ä–º–∞—Ç–µ |
| `websocketPort` | number | –ü–æ—Ä—Ç WebSocket —Å–µ—Ä–≤–µ—Ä–∞ |

### System Status

| –ü–æ–ª–µ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|-----|----------|
| `redisConnected` | boolean | –°—Ç–∞—Ç—É—Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Redis |
| `botStatus` | string | –°—Ç–∞—Ç—É—Å —Ç–æ—Ä–≥–æ–≤–æ–≥–æ –±–æ—Ç–∞ (idle, running, error) |
| `traderStatus` | string | –°—Ç–∞—Ç—É—Å —Ç—Ä–µ–π–¥–µ—Ä–∞ (idle, running, error) |
| `lastTradeSignal` | string | –ü–æ—Å–ª–µ–¥–Ω–∏–π —Ç–æ—Ä–≥–æ–≤—ã–π —Å–∏–≥–Ω–∞–ª –∏–ª–∏ "None" |

### Available Events

–°–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π –¥–ª—è –ø–æ–¥–ø–∏—Å–∫–∏:

- `system:status` - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ —Å–∏—Å—Ç–µ–º—ã
- `trade:signal` - –ù–æ–≤—ã–π —Ç–æ—Ä–≥–æ–≤—ã–π —Å–∏–≥–Ω–∞–ª
- `trade:executed` - –ò—Å–ø–æ–ª–Ω–µ–Ω–Ω–∞—è —Å–¥–µ–ª–∫–∞
- `trade:error` - –û—à–∏–±–∫–∞ —Ç–æ—Ä–≥–æ–≤–ª–∏
- `market:update` - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä—ã–Ω–æ—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- `ping` - –ü–∏–Ω–≥ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
- `pong` - –û—Ç–≤–µ—Ç –Ω–∞ –ø–∏–Ω–≥

### Available Commands

| –ö–æ–º–∞–Ω–¥–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------|----------|
| `subscribe` | –ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è |
| `unsubscribe` | –û—Ç–ø–∏—Å–∞—Ç—å—Å—è –æ—Ç —Å–æ–±—ã—Ç–∏–π |
| `status` | –ü–æ–ª—É—á–∏—Ç—å —Ç–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã |
| `help` | –ü–æ–ª—É—á–∏—Ç—å —Å–ø—Ä–∞–≤–æ—á–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é |

### Documentation

| –ü–æ–ª–µ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|-----|----------|
| `api` | string | –°—Å—ã–ª–∫–∞ –Ω–∞ API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é |
| `github` | string | –°—Å—ã–ª–∫–∞ –Ω–∞ GitHub —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π |
| `support` | string | Email –ø–æ–¥–¥–µ—Ä–∂–∫–∏ |

### Tips

–ü–æ–ª–µ–∑–Ω—ã–µ —Å–æ–≤–µ—Ç—ã –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é API:

1. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `{"type":"ping"}` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
2. –û—Ç–ø—Ä–∞–≤–ª—è–π—Ç–µ `{"type":"status"}` –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–µ–∫—É—â–µ–≥–æ —Å—Ç–∞—Ç—É—Å–∞ —Å–∏—Å—Ç–µ–º—ã
3. –í—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤–∞–ª–∏–¥–Ω—ã–º JSON
4. –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä —Å–æ–æ–±—â–µ–Ω–∏—è: 16KB

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### JavaScript –∫–ª–∏–µ–Ω—Ç

```javascript
const WebSocket = require('ws');

const ws = new WebSocket('ws://localhost:2808');

ws.on('message', (data) => {
  const message = JSON.parse(data);
  
  if (message.type === 'system:welcome') {
    console.log('Welcome!', message.message);
    console.log('Client ID:', message.clientId);
    console.log('Available events:', message.availableEvents);
  }
});
```

### Python –∫–ª–∏–µ–Ω—Ç

```python
import json
import websocket

def on_message(ws, message):
    data = json.loads(message)
    if data['type'] == 'system:welcome':
        print(f"Welcome: {data['message']}")
        print(f"Client ID: {data['clientId']}")

ws = websocket.WebSocketApp("ws://localhost:2808", on_message=on_message)
ws.run_forever()
```

## –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è

–ö–ª–∏–µ–Ω—Ç—ã –¥–æ–ª–∂–Ω—ã:

1. **–û–∂–∏–¥–∞—Ç—å –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ** —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
2. **–°–æ—Ö—Ä–∞–Ω–∏—Ç—å clientId** –¥–ª—è –±—É–¥—É—â–∏—Ö –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π
3. **–ü—Ä–æ–≤–µ—Ä—è—Ç—å —Å–∏—Å—Ç–µ–º—É —Å—Ç–∞—Ç—É—Å** –ø–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º —Ä–∞–±–æ—Ç—ã
4. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–æ—Å—Ç—É–ø–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è** –¥–ª—è –ø–æ–¥–ø–∏—Å–∫–∏ –Ω–∞ –Ω—É–∂–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ:

```bash
# JavaScript —Ç–µ—Å—Ç
node test_welcome_client.js

# Python —Ç–µ—Å—Ç
python3 test_welcome_python.py
```

## –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏

1. **–í—Å–µ–≥–¥–∞ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–π—Ç–µ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ** –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π –¥—Ä—É–≥–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
2. **–°–æ—Ö—Ä–∞–Ω—è–π—Ç–µ clientId** –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
3. **–ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ systemStatus** –ø–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º —Ç–æ—Ä–≥–æ–≤–ª–∏
4. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è** –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ —Ç—Ä–∞—Ñ–∏–∫–∞
5. **–°–ª–µ–¥—É–π—Ç–µ —Å–æ–≤–µ—Ç–∞–º** –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã

## –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

- WebSocket –ø—Ä–æ—Ç–æ–∫–æ–ª RFC 6455
- JSON —Ñ–æ—Ä–º–∞—Ç —Å–æ–æ–±—â–µ–Ω–∏–π
- Node.js 14+
- Python 3.6+
- –í—Å–µ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –±—Ä–∞—É–∑–µ—Ä—ã

## –õ–∏—Ü–µ–Ω–∑–∏—è

MIT ¬© DTrader Team